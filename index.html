<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜ä¸­ç‡ŸéšŠè³‡è¨Šå¹³å°</title>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>å…¨å°é«˜ä¸­ç‡ŸéšŠè³‡è¨Šå¹³å° | å¤§å­¸ç‡ŸéšŠæŸ¥è©¢èˆ‡å ±å</title>
    <meta name="description" content="å½™æ•´å…¨å°å„å¤§å°ˆé™¢æ ¡ã€é«˜ä¸­è·å¯’æš‘å‡ç‡ŸéšŠè³‡è¨Šã€‚æä¾›åŒ—ä¸­å—æ±å„åœ°å€ç‡ŸéšŠæŸ¥è©¢ã€å ±åé€£çµèˆ‡é™„ä»¶ä¸‹è¼‰ï¼Œå¹«åŠ©é«˜ä¸­ç”Ÿæ¢ç´¢å¤§å­¸ç§‘ç³»ã€‚">
    <meta name="keywords" content="é«˜ä¸­ç‡ŸéšŠ, å¤§å­¸ç‡ŸéšŠ, å¯’å‡ç‡ŸéšŠ, æš‘å‡ç‡ŸéšŠ, ç‡ŸéšŠå ±å, ç§‘ç³»æ¢ç´¢, å­¸ç¿’æ­·ç¨‹, è¥¿èºè¾²å·¥, ç‡ŸéšŠè³‡è¨Š">
    <meta name="author" content="æ¢“ç¿”è‚¡ä»½æœ‰é™å…¬å¸">
    
    <meta property="og:title" content="å…¨å°é«˜ä¸­ç‡ŸéšŠè³‡è¨Šå¹³å°">
    <meta property="og:description" content="æœ€æ–°ã€æœ€å®Œæ•´çš„å…¨å°é«˜ä¸­ç‡ŸéšŠæ‡¶äººåŒ…ï¼Œä¸€éµæŸ¥è©¢ã€è‡ªå‹•ç¯©é¸ï¼">
    <meta property="og:image" content="https://cdn-icons-png.flaticon.com/512/3069/3069172.png"> <meta property="og:url" content="æ‚¨çš„GitHubPagesç¶²å€">
    <meta property="og:type" content="website">

    </head>
   <link rel="icon" href="https://cdn-icons-png.flaticon.com/128/18932/18932701.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        /* =========================================
           1. å…¨åŸŸè®Šæ•¸èˆ‡é‡ç½®
           ========================================= */
        :root {
            --primary-green: #6fb7b7;
            --primary-blue: #6cacd6;
            --primary-pink: #f78da7;
            --primary-orange: #f4a460;
            --primary-yellow: #f0d676;
            --bg-body: #f9f9f9;
            --bg-card: #ffffff;
            --bg-header: #ffffff;
            --text-main: #555555;
            --text-title: #333333;
            --text-muted: #888888;
            --border-color: #eeeeee;
            --shadow-color: rgba(0,0,0,0.05);
            --footer-bg: #ffcc33;
            --footer-text: #555;
            --badge-new: #ff4757;
            --ripple-size: 150px; 
            --ripple-duration: 0.6s;
        }

        body.dark-mode {
            --bg-body: #0f0f0f;
            --bg-card: #272727;
            --bg-header: #0f0f0f;
            --text-main: #f1f1f1;
            --text-title: #ffffff;
            --text-muted: #aaaaaa;
            --border-color: #3f3f3f;
            --shadow-color: rgba(0,0,0,0.5);
            --footer-bg: #3e3e3e;
            --footer-text: #ccc;
        }

        body {
            font-family: "Noto Sans TC", sans-serif;
            margin: 0; padding: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            min-height: 100vh;
            display: flex; flex-direction: column;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }
        a { text-decoration: none; }

        /* =========================================
           2. å‹•ç•«ç‰¹æ•ˆ
           ========================================= */
        .click-ripple {
            position: absolute;
            border-radius: 50%;
            transform: translate(-50%, -50%); pointer-events: none;
            animation: ripple-anim var(--ripple-duration) linear forwards; 
            z-index: 9999;
        }
        @keyframes ripple-anim { 
            0% { width: 0; height: 0; opacity: 0.6; } 
            100% { width: var(--ripple-size); height: var(--ripple-size); opacity: 0; } 
        }
        .confetti {
            position: absolute;
            width: 8px; height: 8px; background-color: var(--confetti-color);
            pointer-events: none; z-index: 10000; animation: confetti-fall 1s ease-out forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) rotate(720deg); opacity: 0; }
        }
        @keyframes floatImg { 
            0% { transform: translateY(0px); } 
            50% { transform: translateY(-15px); } 
            100% { transform: translateY(0px); } 
        }

        /* =========================================
           3. ä»‹é¢æ¨£å¼
           ========================================= */
        .site-header { 
            background: var(--bg-header);
            box-shadow: 0 2px 10px var(--shadow-color); 
            padding: 15px 0; position: sticky; top: 0; z-index: 100; transition: background 0.3s;
            border-bottom: 1px solid var(--border-color);
        }
        .header-container { max-width: 1200px; margin: 0 auto;
            padding: 0 20px; display: flex; align-items: center; justify-content: space-between; } 
        .logo-area { display: flex;
            align-items: center; gap: 10px; font-size: 1.5em; font-weight: bold; color: var(--primary-green); cursor: pointer;
        }
        .logo-icon { font-size: 32px; }
        .settings-btn { font-size: 28px; color: var(--text-muted); cursor: pointer; transition: 0.3s; padding: 5px;
            border-radius: 50%; }
        .settings-btn:hover { background: var(--border-color); color: var(--primary-green); transform: rotate(90deg);
        }

        /* è¨­å®šé¢æ¿ */
        .settings-panel {
            position: fixed;
            top: 70px; right: 20px; background: var(--bg-card); width: 280px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3); border-radius: 12px; padding: 20px;
            z-index: 2000;
            border: 1px solid var(--border-color); display: none; animation: slideIn 0.3s ease;
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .settings-header { display: flex;
            justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;
        }
        .settings-title { font-weight: bold; color: var(--text-title); font-size: 1.1em; }
        .settings-close { cursor: pointer; font-size: 20px; color: var(--text-muted); }
        .setting-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .setting-label { font-size: 0.95em; color: var(--text-main); }
        .switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0;
            bottom: 0; background-color: #555; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute;
            content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--primary-green); }
        input:checked + .slider:before { transform: translateX(24px); }

        /* Line Bot æŒ‰éˆ• */
        .line-bot-btn {
            display: flex;
            align-items: center; justify-content: center; gap: 8px;
            width: 100%; padding: 10px; margin-top: 15px;
            background-color: #06c755; color: white; font-weight: bold;
            border-radius: 8px;
            text-decoration: none; transition: 0.2s;
        }
        .line-bot-btn:hover { background-color: #05b34c; }

        /* ç‰¹è‰²å€ */
        .hero-section {
            max-width: 1200px;
            margin: 30px auto 10px; padding: 0 20px;
            display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;
        }
        .feature-card {
            border-radius: 15px;
            padding: 25px 20px; color: white; text-align: center; 
            position: relative; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); user-select: none;
        }
        .feature-card:hover { transform: translateY(-3px); }
        .feature-icon { font-size: 32px; margin-bottom: 10px; display: block; opacity: 0.9; }
        .feat-title { font-size: 1.3em; font-weight: bold; margin-bottom: 5px; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .feat-desc { font-size: 0.85em; opacity: 0.95; }
        .bg-green { background: linear-gradient(135deg, #81c7c7, #5ea5a5); }
        .bg-blue { background: linear-gradient(135deg, #89caff, #569bd6); }
        .bg-pink { background: linear-gradient(135deg, #ff9eb5, #d66b84); }
        .bg-orange { background: linear-gradient(135deg, #ffb870, #d68a40); }
        .bg-yellow { background: linear-gradient(135deg, #ffe066, #d6c040); }

        /* æœå°‹èˆ‡æ§åˆ¶å€ */
        .search-section { max-width: 1000px; margin: 50px auto 20px; padding: 0 20px; position: relative; }
        .mascot { position: absolute; top: -45px; left: 40px; font-size: 50px; color: var(--text-title); animation: floatImg 3s ease-in-out infinite; }
        
        .search-bar-wrapper {
            display: flex;
            background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 50px;
            padding: 5px; box-shadow: 0 4px 15px var(--shadow-color); transition: border-color 0.3s; position: relative;
        }
        .search-bar-wrapper:focus-within { border-color: var(--primary-green); }
        #searchInput {
            flex: 1;
            border: none; outline: none; padding: 15px 25px; font-size: 16px; 
            border-radius: 50px 0 0 50px; padding-right: 40px; background: transparent; color: var(--text-main);
        }
        #clearBtn {
            position: absolute;
            right: 140px; top: 50%; transform: translateY(-50%);
            font-size: 24px; color: var(--text-muted); cursor: pointer; display: none; transition: color 0.2s; z-index: 10;
        }
        #clearBtn:hover { color: #e91e63; }
        .search-btn {
            background-color: #6c757d;
            color: white; border: none; padding: 10px 40px;
            border-radius: 50px; font-size: 16px; cursor: pointer; font-weight: bold; transition: 0.2s; margin: 3px;
        }
        .search-btn:hover { background-color: #5a6268; }

        /* åœ°å€ç¯©é¸å·¥å…·åˆ— */
        .region-toolbar {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: nowrap; /* ç¢ºä¿ä¸æ›è¡Œï¼Œæ”¯æ´æ©«å‘æ»‘å‹• */
            overflow-x: auto; /* æ”¯æ´æ‰‹æ©Ÿæ»‘å‹• */
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch; /* iOS æ»‘å‹•å„ªåŒ– */
        }
        .region-toolbar::-webkit-scrollbar { display: none; } /* éš±è—æ²è»¸ */

        .region-btn {
            white-space: nowrap;
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
            color: var(--text-main);
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        .region-btn:hover {
            border-color: var(--primary-green);
            color: var(--primary-green);
        }
        .region-btn.active {
            background-color: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
            box-shadow: 0 4px 10px rgba(111, 183, 183, 0.4);
        }

        /* å·¥å…·åˆ— (æ’åº) - ç§»é™¤æ”¶è— */
        .toolbar { display: flex;
            gap: 10px; margin-top: 15px; justify-content: flex-end; align-items: center; flex-wrap: wrap;
        }
        
        /* ç¾åŒ–ç‰ˆä¸‹æ‹‰é¸å–® */
        .select-wrapper { position: relative; display: inline-block; }
        .sort-select {
            appearance: none; -webkit-appearance: none;
            padding: 8px 35px 8px 16px; border-radius: 20px; background: var(--bg-card);
            border: 1px solid var(--border-color); color: var(--text-main); font-size: 0.9em;
            outline: none; cursor: pointer; transition: 0.2s; font-family: inherit;
        }
        .sort-select:hover { border-color: var(--primary-green); }
        .select-icon {
            position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
            pointer-events: none; color: var(--text-muted); font-size: 14px;
        }

        /* å…§å®¹èˆ‡å¡ç‰‡ */
        .main-content { max-width: 1200px;
            margin: 0 auto 60px; padding: 0 20px; flex: 1; }
        .section-header { display: flex;
            align-items: center; margin-bottom: 20px; border-left: 5px solid var(--primary-orange); padding-left: 15px;
        }
        .section-title { font-size: 1.5em; font-weight: bold; color: var(--text-title); }

        .camp-list { display: grid; gap: 20px; grid-template-columns: 1fr; }
        @media (min-width: 600px) { .camp-list { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 900px) { .camp-list { grid-template-columns: repeat(3, 1fr); } }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background: var(--bg-card);
            border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px var(--shadow-color);
            border: 1px solid var(--border-color); cursor: pointer; transition: all 0.3s; position: relative;
            opacity: 0; animation: fadeInCard 0.5s ease forwards;
        }
        .card:hover { transform: translateY(-5px);
            box-shadow: 0 8px 20px var(--shadow-color); border-color: var(--primary-green); }
        
        .card.read .card-title { color: var(--text-muted); }
        .card.read::after { content: "âœ“ å·²è®€"; position: absolute; bottom: 15px; right: 15px;
            font-size: 0.8em; color: var(--primary-green); font-weight: bold; }
        .card-badge {
            position: absolute;
            top: -10px; left: -10px; background: var(--badge-new); color: white;
            font-size: 0.75em; padding: 4px 10px; border-radius: 20px; font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 2; transform: rotate(-5deg);
        }

        .card-meta { margin-bottom: 10px; display: flex; gap: 8px; flex-wrap: wrap; }
        .card-date, .card-region { 
            display: inline-block; background-color: var(--border-color); 
            color: var(--text-main); padding: 4px 10px;
            border-radius: 4px; font-size: 0.85em; font-weight: 500; 
        }
        .card-region { background-color: #e0f7fa; color: #006064; } /* åœ°å€æ¨™ç±¤é¡è‰² */

        .card-title { font-size: 1.2em;
            font-weight: bold; color: var(--text-title); line-height: 1.5; margin-bottom: 10px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
            transition: color 0.3s;}
        .card-preview { color: var(--text-muted); font-size: 0.9em; display: flex; align-items: center;
            gap: 5px; }
        @keyframes fadeInCard { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* é å°¾ */
        .site-footer { background-color: var(--footer-bg);
            color: var(--footer-text); text-align: center; padding: 20px; font-size: 0.9em; font-weight: bold;
        }
        .pagination { display: flex; justify-content: center; gap: 8px; margin-top: 40px; }
        .page-btn { background: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-main);
            padding: 8px 14px; border-radius: 6px; cursor: pointer; }
        .page-btn.active { background: var(--primary-green);
            color: white; border-color: var(--primary-green); }
        .no-result { text-align: center; padding: 60px 20px; display: none; }
        .no-result img { width: 150px; height: 150px; margin-bottom: 20px;
            opacity: 0.9; animation: floatImg 3s ease-in-out infinite; }
        .loading { text-align: center;
            padding: 50px; color: var(--text-muted); width: 100%; }

        /* å½ˆçª— */
        .modal-overlay { display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; backdrop-filter: blur(2px); justify-content: center; align-items: center;
        }
        .modal { background: var(--bg-card); width: 90%; max-width: 800px; max-height: 85vh; border-radius: 20px;
            padding: 30px; overflow-y: auto; position: relative; animation: slideUp 0.3s ease; box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        @keyframes slideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-close { position: absolute;
            top: 20px; right: 25px; font-size: 28px; cursor: pointer; color: var(--text-muted);
        }
        .modal-title { font-size: 1.6em; font-weight: bold; margin-bottom: 10px; color: var(--primary-green); }
        .modal-content { line-height: 1.8; color: var(--text-main); white-space: pre-wrap; margin-top: 20px; }
        .modal-actions { display: flex; gap: 10px; margin-top: 30px; }
        .original-link-btn { flex: 2; text-align: center; background: var(--primary-green); color: white; padding: 15px;
            border-radius: 10px; font-weight: bold; transition: 0.2s; }
        .share-btn-modal { flex: 1; text-align: center;
            background: var(--primary-pink); color: white; padding: 15px; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center;
            gap: 5px; }
        .share-btn-modal:hover { background: #e66b88; }
        .attach-link { display: inline-block; background: var(--bg-card); border: 1px solid var(--primary-blue);
            padding: 8px 15px; border-radius: 20px; color: var(--primary-blue); margin: 5px 5px 0 0; font-size: 0.9em; transition: 0.2s;
        }
        .attach-link:hover { background: var(--primary-blue); color: white; }
    </style>
</head>
<body>

    <header class="site-header">
        <div class="header-container">
            <div class="logo-area" onclick="location.reload()">
                <i class="ph ph-student logo-icon"></i>
                <span>CampInfo</span>
            </div>
            <i class="ph ph-gear settings-btn" onclick="toggleSettings()"></i>
        </div>
    </header>

    <div id="settingsPanel" class="settings-panel">
        <div class="settings-header">
            <span class="settings-title">ç¶²ç«™è¨­å®š</span>
            <i class="ph ph-x settings-close" onclick="toggleSettings()"></i>
        </div>
        <div class="setting-item">
            <span class="setting-label">ğŸŒ™ æš—é»‘æ¨¡å¼</span>
            <label class="switch"><input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()"><span class="slider"></span></label>
        </div>
        <div class="setting-item">
            <span class="setting-label">âœ¨ ç¥ç¥•å½©èŠ±æ¨¡å¼</span>
            <label class="switch"><input type="checkbox" id="mysteryToggle" onchange="toggleMystery()"><span class="slider"></span></label>
        </div>
        <div style="margin-top: 10px; font-size: 0.8em; color: var(--text-muted); text-align: center;">
            <i class="ph ph-confetti"></i> é–‹å•Ÿç¥ç¥•æ¨¡å¼ï¼Œé»æ“Šç•«é¢äº«å—æ´¾å°ï¼
        </div>

        <a href="#" id="lineBotLink" target="_blank" class="line-bot-btn">
            <i class="ph ph-robot" style="font-size: 20px;"></i>
            åŠ å…¥ Line é€šçŸ¥æ©Ÿå™¨äºº
        </a>
    </div>

    <section class="hero-section">
        <div class="feature-card bg-green"><i class="ph ph-lightning feature-icon"></i><div class="feat-title">å³æ™‚æ›´æ–°</div><div class="feat-desc">åŒæ­¥å„å¤§æ ¡ç³»å…¬å‘Š</div></div>
        <div class="feature-card bg-blue"><i class="ph ph-shield-check feature-icon"></i><div class="feat-title">å®˜æ–¹ä¾†æº</div><div class="feat-desc">è³‡è¨Šæº–ç¢ºæœ‰ä¿éšœ</div></div>
        <div class="feature-card bg-pink"><i class="ph ph-gift feature-icon"></i><div class="feat-title">å®Œå…¨å…è²»</div><div class="feat-desc">é–‹æ”¾æ‰€æœ‰è³‡æºæŸ¥è©¢</div></div>
        <div class="feature-card bg-orange"><i class="ph ph-squares-four feature-icon"></i><div class="feat-title">é ˜åŸŸå¤šå…ƒ</div><div class="feat-desc">æ¶µè“‹18å­¸ç¾¤ç‡ŸéšŠ</div></div>
        <div class="feature-card bg-yellow"><i class="ph ph-device-mobile feature-icon"></i><div class="feat-title">éŸ¿æ‡‰è¨­è¨ˆ</div><div class="feat-desc">æ‰‹æ©Ÿå¹³æ¿è¼•é¬†çœ‹</div></div>
    </section>

    <section class="search-section">
        <i class="ph ph-robot mascot"></i>
        
        <div class="search-bar-wrapper">
            <input type="text" id="searchInput" placeholder="æœå°‹ å­¸æ ¡ / ç‡ŸéšŠ / ç ”ç¿’èª²ç¨‹..." onkeyup="handleSearchInput()">
            <i id="clearBtn" class="ph ph-x-circle" onclick="clearSearch()"></i>
            <button class="search-btn" onclick="filterData()">æœå°‹</button>
        </div>

        <div class="region-toolbar">
            <button class="region-btn active" onclick="setRegionFilter('all', this)">ğŸŒ å…¨éƒ¨</button>
            <button class="region-btn" onclick="setRegionFilter('åŒ—å€', this)">åŒ—éƒ¨</button>
            <button class="region-btn" onclick="setRegionFilter('ä¸­å€', this)">ä¸­éƒ¨</button>
            <button class="region-btn" onclick="setRegionFilter('å—å€', this)">å—éƒ¨</button>
            <button class="region-btn" onclick="setRegionFilter('æ±å€', this)">æ±éƒ¨</button>
            <button class="region-btn" onclick="setRegionFilter('å…¨å°/ç·šä¸Š', this)">ç·šä¸Š/å…¶ä»–</button>
        </div>

        <div class="toolbar">
            <div class="select-wrapper">
                <select class="sort-select" id="sortSelect" onchange="handleSort()">
                    <option value="newest">ğŸ“… æ—¥æœŸï¼šç”±æ–°åˆ°èˆŠ</option>
                    <option value="oldest">ğŸ“… æ—¥æœŸï¼šç”±èˆŠåˆ°æ–°</option>
                    <option value="month">ğŸ“… æ—¥æœŸï¼šä¸€å€‹æœˆå…§</option>
                </select>
                <i class="ph ph-caret-down select-icon"></i>
            </div>
        </div>
    </section>

    <main class="main-content">
        <div class="section-header"><div class="section-title">æœ€æ–°ç‡ŸéšŠå°ˆå€</div></div>

        <div id="loading" class="loading"><i class="ph ph-spinner-gap" style="font-size: 40px; animation: spin 1s linear infinite;"></i><br><br>è¼‰å…¥ä¸­...</div>
        
        <div id="noResult" class="no-result">
            <img src="https://cdn-icons-png.flaticon.com/512/6134/6134065.png" alt="æŸ¥ç„¡è³‡æ–™">
            <p>ğŸ˜• å“å‘€ï¼æ²’æœ‰æ‰¾åˆ°ç¬¦åˆçš„ç‡ŸéšŠ...</p>
        </div>

        <div id="campList" class="camp-list"></div>
        <div id="pagination" class="pagination"></div>
    </main>

    <footer class="site-footer">
        æˆ‘å€‘ä½¿ç”¨ Cookie ä¾†æä¾›æœå‹™ã€‚Â© <span id="year"></span> æ¢“ç¿”è‚¡ä»½æœ‰é™å…¬å¸. All rights reserved.
    </footer>

    <div id="modalOverlay" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal">
            <span class="modal-close" onclick="closeModalBtn()">Ã—</span>
            <div id="modalDate" style="color:var(--text-muted); margin-bottom:5px;"></div>
            <div id="modalTitle" class="modal-title"></div>
            <div id="modalContent" class="modal-content"></div>
            <div id="attachSection" style="margin-top:20px; display:none; background:var(--border-color); padding:15px; border-radius:10px;">
                <b style="color:var(--text-main);">ğŸ“ ç›¸é—œé™„ä»¶ï¼š</b><br><div id="modalAttachments" style="margin-top:10px;"></div>
            </div>
            <div class="modal-actions">
                <a id="modalLink" href="#" target="_blank" class="original-link-btn">å‰å¾€åŸå§‹å…¬å‘Š</a>
                <div class="share-btn-modal" onclick="shareCurrentCamp()">
                    <i class="ph ph-share-network"></i> åˆ†äº«
                </div>
            </div>
        </div>
    </div>

<script>
    // ===============================================
    // â˜…â˜…â˜… è¨­å®šå€ â˜…â˜…â˜…
    // ===============================================
    const API_URL = "https://script.google.com/macros/s/AKfycbxNOG_cxSIFr7RKC5mlb8wGpKBmUrTPMFv4QqNy0hxWj9X5deMX3V7NBt7mwoI_5V0S/exec";
    const LINE_BOT_ID = "@087ptzrl";
    // ===============================================

    let allCamps = [], filteredCamps = [], currentPage = 1;
    const itemsPerPage = 12; 
    let readHistory = JSON.parse(localStorage.getItem('camp_read')) || [];
    let currentRegion = 'all'; // ç›®å‰é¸æ“‡çš„åœ°å€
    let isMysteryMode = false;
    let currentModalCamp = null;
    let latestPostDate = null; // å„²å­˜æœ€æ–°çš„æ—¥æœŸ

    // åˆå§‹åŒ–
    document.getElementById('year').innerText = new Date().getFullYear();
    if(LINE_BOT_ID) document.getElementById('lineBotLink').href = "https://line.me/R/ti/p/" + LINE_BOT_ID;
    
    fetch(API_URL).then(res => res.json()).then(data => {
        document.getElementById('loading').style.display = 'none';
        allCamps = data.reverse(); 

        // â˜…â˜…â˜… æ‰¾å‡ºæœ€æ–°çš„é‚£ä¸€ç­†è³‡æ–™æ—¥æœŸ (ä½œç‚º NEW çš„åŸºæº–) â˜…â˜…â˜…
        if (allCamps.length > 0) {
            let maxDate = new Date(0);
            allCamps.forEach(c => {
                let dStr = c.date ? String(c.date).substring(0, 10) : '';
                if(dStr) {
                    let d = new Date(dStr);
                    if(d > maxDate) maxDate = d;
                }
            });
            latestPostDate = maxDate;
        }
        
        // â˜… å¼·åˆ¶å‰ç«¯é‡æ–°åˆ†é¡
        allCamps.forEach(camp => {
            camp.region = autoClassifyRegion(camp.title, camp.content);
        });

        applyFilters(); 
    }).catch(e => { console.error(e); });

    // â˜…â˜…â˜… å¼·å¤§çš„è‡ªå‹•åˆ†é¡å‡½å¼ â˜…â˜…â˜…
    function autoClassifyRegion(title, content) {
        const fullText = (title + " " + content).toLowerCase();
        
        // 1. åŒ—å€ (åŒ…å«ç¸£å¸‚èˆ‡å¤§å­¸)
        const northKeywords = [
            "åŸºéš†", "å°åŒ—", "è‡ºåŒ—", "æ–°åŒ—", "æ¡ƒåœ’", "æ–°ç«¹", "å®œè˜­",
            "å°å¤§", "è‡ºå¤§", "æ”¿å¤§", "å¸«å¤§", "é™½æ˜", "äº¤å¤§", "æ¸…è¯", "ä¸­å¤®", "è¼”ä»", "æ·¡æ±Ÿ", "åŒ—ç§‘", "å°ç§‘", "æ–‡åŒ–å¤§å­¸", "éŠ˜å‚³", "å¯¦è¸", "ä¸–æ–°", "åŒ—é†«", "åœ‹åŒ—æ•™", "å¸‚åŒ—æ•™", "é¦¬å•", "é•·åºš"
        ];
        // 2. ä¸­å€
        const centralKeywords = [
            "è‹—æ —", "å°ä¸­", "è‡ºä¸­", "å½°åŒ–", "å—æŠ•", "é›²æ—", "è¥¿èº", "è¾²å·¥", "æ­£å¿ƒ",
            "ä¸­èˆˆ", "æ±æµ·", "é€¢ç”²", "éœå®œ", "æš¨å—", "å½°å¸«", "é›²ç§‘", "è™å°¾", "å‹¤ç›Š", "æœé™½", "äºæ´²", "ä¸­å±±é†«", "ä¸­åœ‹é†«", "è¯å¤§"
        ];
        // 3. å—å€
        const southKeywords = [
            "å˜‰ç¾©", "å°å—", "è‡ºå—", "é«˜é›„", "å±æ±", 
            "æˆå¤§", "ä¸­å±±å¤§å­¸", "ä¸­æ­£", "é«˜å¸«", "é«˜é†«", "ç¾©å®ˆ", "å±ç§‘", "å˜‰å¤§", "å—å°", "å´‘å±±", "é«˜ç§‘", "æ–‡è—»", "æ¨¹å¾·", "æµ·ç§‘"
        ];
        // 4. æ±å€
        const eastKeywords = ["èŠ±è“®", "å°æ±", "è‡ºæ±", "æ±è¯", "æ…ˆæ¿Ÿ", "å°æ±å¤§å­¸"];
        
        // â˜… å·²ç§»é™¤ã€Œå¤–å³¶ã€åˆ†é¡é—œéµå­—ï¼Œå°‡å®ƒå€‘æ­¸é¡ç‚ºå…¨å°/ç·šä¸Šæˆ–å…¶ä»–
        // const islandKeywords = ["æ¾æ¹–", "é‡‘é–€", "é¦¬ç¥–"]; // ç§»é™¤

        // å„ªå…ˆé †åºï¼šæ¨™é¡Œ > å…§å®¹
        for(let k of northKeywords) if(fullText.includes(k.toLowerCase())) return "åŒ—å€";
        for(let k of centralKeywords) if(fullText.includes(k.toLowerCase())) return "ä¸­å€";
        for(let k of southKeywords) if(fullText.includes(k.toLowerCase())) return "å—å€";
        for(let k of eastKeywords) if(fullText.includes(k.toLowerCase())) return "æ±å€";
        
        return "å…¨å°/ç·šä¸Š";
    }

    function setRegionFilter(region, btn) {
        currentRegion = region;
        document.querySelectorAll('.region-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        applyFilters();
    }

    function applyFilters() {
        const keyword = document.getElementById('searchInput').value.toLowerCase().trim();
        const sortType = document.getElementById('sortSelect').value;

        // A. é—œéµå­—æœå°‹
        let temp = allCamps.filter(c => c.title.toLowerCase().includes(keyword) || (c.content && c.content.toLowerCase().includes(keyword)));

        // B. åœ°å€ç¯©é¸
        if (currentRegion !== 'all') {
            temp = temp.filter(c => c.region === currentRegion);
        }

        // C. æ—¥æœŸç¯©é¸èˆ‡æ’åº
        if (sortType === 'month') {
            const today = new Date();
            const oneMonthAgo = new Date();
            oneMonthAgo.setDate(today.getDate() - 30);
            temp = temp.filter(c => {
                let d = new Date(c.date);
                return d >= oneMonthAgo;
            });
            temp.sort((a, b) => new Date(b.date) - new Date(a.date));
        } else if (sortType === 'oldest') {
            temp.sort((a, b) => new Date(a.date) - new Date(b.date));
        } else {
            temp.sort((a, b) => new Date(b.date) - new Date(a.date));
        }

        filteredCamps = temp;
        renderPage(1);
    }

    function handleSearchInput() {
        const val = document.getElementById('searchInput').value;
        document.getElementById('clearBtn').style.display = val.length > 0 ? 'block' : 'none';
        applyFilters();
    }
    function clearSearch() {
        const input = document.getElementById('searchInput');
        input.value = '';
        document.getElementById('clearBtn').style.display = 'none';
        applyFilters();
        input.focus();
    }
    function handleSort() { applyFilters(); }

    function renderPage(page) {
        currentPage = page;
        const list = document.getElementById('campList');
        const noRes = document.getElementById('noResult');
        list.innerHTML = '';
        if(filteredCamps.length === 0) {
            noRes.style.display = 'block';
            document.getElementById('pagination').innerHTML = '';
            return;
        }
        noRes.style.display = 'none';
        const start = (page - 1) * itemsPerPage;
        const items = filteredCamps.slice(start, start + itemsPerPage);

        items.forEach((camp, idx) => {
            let dStr = camp.date ? String(camp.date).substring(0, 10) : '';
            if(dStr.includes('T')) dStr = dStr.split('T')[0];
            
            // â˜…â˜…â˜… ä¿®æ”¹ NEW é‚è¼¯ï¼šåªæœ‰æ—¥æœŸã€Œç­‰æ–¼ã€æœ€æ–°ç™¼å¸ƒæ—¥çš„æ–‡ç« æ‰æœƒæœ‰ NEW â˜…â˜…â˜…
            // ä¾‹å¦‚æœ€æ–°æ˜¯ 12/23ï¼Œé‚£ 12/22 å°±ä¸æœƒæœ‰ NEW
            let isNew = false;
            if (latestPostDate && dStr) {
                const campDate = new Date(dStr);
                // æ¯”è¼ƒæ™‚é–“æˆ³è¨˜ï¼Œå¿½ç•¥æ™‚åˆ†ç§’å·®ç•°ï¼ˆåªæ¯”å°æ—¥æœŸï¼‰
                if (campDate.toDateString() === latestPostDate.toDateString()) {
                    isNew = true;
                }
            }

            const isRead = readHistory.includes(camp.link);
            
            const card = document.createElement('div');
            card.className = `card ${isRead ? 'read' : ''}`;
            card.style.animationDelay = `${idx * 0.05}s`;

            card.onclick = (e) => { openModal(camp); };

            const regionLabel = camp.region || 'æœªåˆ†é¡';

            card.innerHTML = `
                ${isNew ? '<div class="card-badge">ğŸ”¥ NEW</div>' : ''}
                <div class="card-meta">
                    <span class="card-date">${dStr || 'æœªæ¨™ç¤º'}</span>
                    <span class="card-region">${regionLabel}</span>
                </div>
                <div class="card-title">${camp.title}</div>
                <div class="card-preview"><i class="ph ph-arrow-circle-right"></i> é»æ“ŠæŸ¥çœ‹è©³æƒ…</div>
            `;
            list.appendChild(card);
        });
        renderPagination();
        window.scrollTo({top:0, behavior:'smooth'});
    }

    function markAsRead(link) {
        if (!readHistory.includes(link)) {
            readHistory.push(link);
            localStorage.setItem('camp_read', JSON.stringify(readHistory));
        }
    }

    function shareCurrentCamp() {
        if (!currentModalCamp) return;
        const text = `ã€${currentModalCamp.title}ã€‘\nè©³ç´°è³‡è¨Šï¼š${currentModalCamp.link}\n(ä¾†è‡ª é«˜ä¸­ç‡ŸéšŠè³‡è¨Šå¹³å°)`;
        
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        if (isMobile && navigator.share) {
            navigator.share({
                title: currentModalCamp.title,
                text: text,
                url: currentModalCamp.link
            }).catch(console.error);
        } else {
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('.share-btn-modal');
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="ph ph-check"></i> å·²è¤‡è£½é€£çµï¼';
                btn.style.background = '#4cd137'; 
                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                    btn.style.background = ''; 
                }, 2000);
            }).catch(err => {
                alert("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ç¶²å€ã€‚");
            });
        }
    }

    function renderPagination() {
        const p = document.getElementById('pagination');
        p.innerHTML = '';
        const total = Math.ceil(filteredCamps.length / itemsPerPage);
        if(total <= 1) return;
        const btn = (txt, onclick, active=false) => {
            const b = document.createElement('button');
            b.innerText = txt; b.className = `page-btn ${active?'active':''}`;
            b.onclick = onclick; p.appendChild(b);
        };
        btn('Â«', () => renderPage(Math.max(1, currentPage-1)));
        let s = Math.max(1, currentPage-2), e = Math.min(total, s+4);
        if(e-s<4) s = Math.max(1, e-4);
        for(let i=s; i<=e; i++) btn(i, () => renderPage(i), i===currentPage);
        btn('Â»', () => renderPage(Math.min(total, currentPage+1)));
    }

    function openModal(camp) {
        currentModalCamp = camp;
        markAsRead(camp.link);
        let d = camp.date ? String(camp.date).substring(0, 10) : '';
        if(d.includes('T')) d = d.split('T')[0];
        document.getElementById('modalDate').innerText = "ç™¼ä½ˆæ—¥æœŸï¼š" + d;
        document.getElementById('modalTitle').innerText = camp.title;
        document.getElementById('modalContent').innerText = camp.content || "ç„¡è©³ç´°å…§å®¹";
        document.getElementById('modalLink').href = camp.link;
        const attDiv = document.getElementById('modalAttachments');
        const attSec = document.getElementById('attachSection');
        attDiv.innerHTML = '';
        if(camp.attachments && camp.attachments.trim() !== "ç„¡é™„ä»¶" && camp.attachments.trim() !== "") {
            attSec.style.display = 'block';
            camp.attachments.split('\n').forEach((url, i) => {
                let name = "é™„ä»¶ " + (i+1);
                try { name = decodeURIComponent(url.split('/').pop().split('?')[0]); } catch(e){}
                const a = document.createElement('a');
                a.href = url; a.target = "_blank"; a.className = 'attach-link';
                a.innerHTML = `<i class="ph ph-file-text"></i> ${name}`;
                attDiv.appendChild(a);
            });
        } else { attSec.style.display = 'none'; }
        document.getElementById('modalOverlay').style.display = 'flex';
    }
    function closeModal(e) { if(e.target.id === 'modalOverlay') document.getElementById('modalOverlay').style.display = 'none'; }
    function closeModalBtn() { document.getElementById('modalOverlay').style.display = 'none'; }

    function toggleSettings() {
        const panel = document.getElementById('settingsPanel');
        panel.style.display = (panel.style.display === 'block') ? 'none' : 'block';
    }
    function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }
    function toggleMystery() {
        isMysteryMode = document.getElementById('mysteryToggle').checked;
        const root = document.documentElement;
        if(isMysteryMode) {
            root.style.setProperty('--ripple-size', '300vmax');
            root.style.setProperty('--ripple-duration', '1.5s');
        } else {
            root.style.setProperty('--ripple-size', '150px');
            root.style.setProperty('--ripple-duration', '0.6s');
        }
    }
    
    document.addEventListener('click', function(e) {
        if(e.target.closest('.settings-panel') || e.target.closest('.settings-btn') || e.target.closest('.card') || e.target.closest('.share-btn-modal')) return;
        
        const ripple = document.createElement('div');
        ripple.classList.add('click-ripple');
        ripple.style.left = e.pageX + 'px';
        ripple.style.top = e.pageY + 'px';
        if(isMysteryMode) {
            const randomHue = Math.floor(Math.random() * 360);
            ripple.style.background = `radial-gradient(circle, hsla(${randomHue}, 100%, 70%, 0.8) 0%, hsla(${randomHue}, 100%, 50%, 0.1) 70%)`;
            createConfetti(e.pageX, e.pageY);
        } else {
            ripple.style.background = getComputedStyle(document.body).getPropertyValue('--primary-green') + "66"; 
        }
        document.body.appendChild(ripple);
        const durationStr = getComputedStyle(document.documentElement).getPropertyValue('--ripple-duration');
        setTimeout(() => { ripple.remove(); }, parseFloat(durationStr) * 1000);
    });
    function createConfetti(x, y) {
        const particleCount = 30;
        for (let i = 0; i < particleCount; i++) {
            const confetti = document.createElement('div');
            confetti.classList.add('confetti');
            const colors = ['#f94144', '#f3722c', '#f8961e', '#f9c74f', '#90be6d', '#43aa8b', '#577590', '#277da1'];
            confetti.style.setProperty('--confetti-color', colors[Math.floor(Math.random() * colors.length)]);
            const angle = Math.random() * Math.PI * 2;
            const velocity = 50 + Math.random() * 100;
            const tx = Math.cos(angle) * velocity;
            const ty = Math.sin(angle) * velocity + 100;
            confetti.style.setProperty('--tx', `${tx}px`);
            confetti.style.setProperty('--ty', `${ty}px`);
            confetti.style.left = x + 'px'; confetti.style.top = y + 'px';
            document.body.appendChild(confetti);
            setTimeout(() => { confetti.remove(); }, 1000);
        }
    }
</script>
</body>
</html>
